<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mini App Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            font-family: sans-serif;
            margin: 0;
            padding: 10px;
            padding-bottom: 80px; /* –ß—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∞ –∫–æ–Ω—Ç–µ–Ω—Ç */
        }

        /* –°–ï–¢–ö–ê –¢–û–í–ê–†–û–í (2 –∫–æ–ª–æ–Ω–∫–∏) */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* –ö–ê–†–¢–û–ß–ö–ê –¢–û–í–ê–†–ê */
        .item {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .item img {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            object-fit: contain;
        }

        .title { font-weight: bold; font-size: 14px; margin: 5px 0; }
        .price { color: var(--tg-theme-hint-color, #888); font-size: 13px; margin-bottom: 8px;}

        /* –ö–ù–û–ü–ö–ò */
        .btn {
            background-color: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            border-radius: 6px;
            padding: 8px;
            font-size: 12px;
            cursor: pointer;
            width: 100%;
        }
        
        .btn-add { background-color: var(--tg-theme-button-color, #2481cc); }
        .btn-desc { background-color: transparent; color: var(--tg-theme-link-color, #2481cc); margin-top: 5px; }

        /* –í–°–ü–õ–´–í–ê–®–ö–ê –° –û–ü–ò–°–ê–ù–ò–ï–ú */
        #popup {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .popup-content {
            background: var(--tg-theme-bg-color, #fff);
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 300px;
            text-align: center;
            position: relative;
        }
        .close-btn {
            position: absolute; top: 10px; right: 15px;
            font-size: 24px; cursor: pointer; color: #888;
        }
    </style>
</head>
<body>

    <!-- –°–Æ–î–ê JS –í–°–¢–ê–í–ò–¢ –¢–û–í–ê–†–´ -->
    <div id="list" class="grid"></div>

    <!-- –û–ö–ù–û –û–ü–ò–°–ê–ù–ò–Ø –¢–û–í–ê–†–ê -->
    <div id="popup">
        <div class="popup-content">
            <span class="close-btn" onclick="closePopup()">&times;</span>
            <h2 id="p-title"></h2>
            <p id="p-desc"></p>
            <h3 id="p-price"></h3>
            <button class="btn" id="p-btn">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –¢–û–í–ê–†–û–í (10 —à—Ç) ---
        const products = [
            {id: 1, title: "–§—É—Ç–±–æ–ª–∫–∞ White", price: 1000, img: "üëï", desc: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –±–µ–ª–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞, 100% —Ö–ª–æ–ø–æ–∫."},
            {id: 2, title: "–î–∂–∏–Ω—Å—ã Slim", price: 2500, img: "üëñ", desc: "–£–∑–∫–∏–µ –¥–∂–∏–Ω—Å—ã, —Å–∏–Ω–∏–π –¥–µ–Ω–∏–º."},
            {id: 3, title: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏ Run", price: 5000, img: "üëü", desc: "–ë–µ–≥–æ–≤—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏, –º—è–≥–∫–∞—è –ø–æ–¥–æ—à–≤–∞."},
            {id: 4, title: "–ö–µ–ø–∫–∞ NY", price: 800, img: "üß¢", desc: "–°—Ç–∏–ª—å–Ω–∞—è –∫–µ–ø–∫–∞ —Å –≤—ã—à–∏–≤–∫–æ–π."},
            {id: 5, title: "–ß–∞—Å—ã Smart", price: 3000, img: "‚åö", desc: "–°—á–∏—Ç–∞—é—Ç —à–∞–≥–∏ –∏ –ø—É–ª—å—Å."},
            {id: 6, title: "–†—é–∫–∑–∞–∫ City", price: 1500, img: "üéí", desc: "–í–º–µ—â–∞–µ—Ç –Ω–æ—É—Ç–±—É–∫ 15 –¥—é–π–º–æ–≤."},
            {id: 7, title: "–û—á–∫–∏ Sun", price: 1200, img: "üï∂Ô∏è", desc: "–ó–∞—â–∏—Ç–∞ –æ—Ç —É–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç–∞."},
            {id: 8, title: "–ù–∞—É—à–Ω–∏–∫–∏ Bass", price: 2000, img: "üéß", desc: "–ì–ª—É–±–æ–∫–∏–π –±–∞—Å –∏ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ."},
            {id: 9, title: "–ß–µ—Ö–æ–ª Phone", price: 500, img: "üì±", desc: "–°–∏–ª–∏–∫–æ–Ω–æ–≤—ã–π –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —á–µ—Ö–æ–ª."},
            {id: 10, title: "–ù–æ—Å–∫–∏ (3 –ø–∞—Ä—ã)", price: 300, img: "üß¶", desc: "–ù–∞–±–æ—Ä –Ω–æ—Å–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å."}
        ];

        // –ö–æ—Ä–∑–∏–Ω–∞ (—Ö—Ä–∞–Ω–∏–º —Ç—É—Ç —Å–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ)
        let cart = [];

        // --- –§–£–ù–ö–¶–ò–Ø –û–¢–†–ò–°–û–í–ö–ò –¢–û–í–ê–†–û–í ---
        const list = document.getElementById('list');
        products.forEach(item => {
            const div = document.createElement('div');
            div.className = 'item';
            div.innerHTML = `
                <div style="font-size: 40px;">${item.img}</div>
                <div class="title">${item.title}</div>
                <div class="price">${item.price} ‚ÇΩ</div>
                <button class="btn btn-add" onclick="addToCart(${item.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn btn-desc" onclick="openPopup(${item.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            `;
            list.appendChild(div);
        });

        // --- –õ–û–ì–ò–ö–ê –ö–û–†–ó–ò–ù–´ ---
        function addToCart(id) {
            const item = products.find(p => p.id === id);
            cart.push(item);
            updateMainButton();
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–ø—Ä–∏—è—Ç–Ω—ã–π —Ç–∞–∫—Ç–∏–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫)
            tg.HapticFeedback.impactOccurred('medium');
        }

        function updateMainButton() {
            if (cart.length === 0) {
                tg.MainButton.hide();
            } else {
                // –°—á–∏—Ç–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É
                const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
                
                tg.MainButton.setText(`–û–ø–ª–∞—Ç–∏—Ç—å ${totalPrice} ‚ÇΩ (${cart.length} —à—Ç)`);
                tg.MainButton.show();
            }
        }

        // --- –õ–û–ì–ò–ö–ê –û–ü–õ–ê–¢–´ (–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É) ---
        tg.MainButton.onClick(function() {
            // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±–æ—Ç–∞
            const data = JSON.stringify({
                items: cart,
                total: cart.reduce((sum, item) => sum + item.price, 0)
            });
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º
            tg.sendData(data);
        });

        // --- –õ–û–ì–ò–ö–ê –ü–û–ü–ê–ü–ê (–û–ü–ò–°–ê–ù–ò–ï) ---
        const popup = document.getElementById('popup');
        
        function openPopup(id) {
            const item = products.find(p => p.id === id);
            document.getElementById('p-title').innerText = item.title;
            document.getElementById('p-desc').innerText = item.desc;
            document.getElementById('p-price').innerText = item.price + " ‚ÇΩ";
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ –ø–æ–ø–∞–ø–∞
            const btn = document.getElementById('p-btn');
            btn.onclick = function() {
                addToCart(id);
                closePopup();
            };
            
            popup.style.display = 'flex';
        }

        function closePopup() {
            popup.style.display = 'none';
        }
    </script>
</body>
</html>
