<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mega Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 10px; padding-bottom: 80px;
        }
        h1 { font-size: 20px; margin-bottom: 15px; }

        /* –°–ï–¢–ö–ê –¢–û–í–ê–†–û–í (2 –∫–æ–ª–æ–Ω–∫–∏) */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* –ö–ê–†–¢–û–ß–ö–ê */
        .card {
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 12px;
            padding: 10px;
            display: flex; flex-direction: column; align-items: center; text-align: center;
        }
        .icon { font-size: 50px; margin-bottom: 5px; }
        .title { font-weight: 600; font-size: 14px; margin-bottom: 5px; height: 34px; display: flex; align-items: center;}
        .price { font-weight: bold; color: var(--tg-theme-hint-color, #888); margin-bottom: 10px; }
        
        button {
            border: none; border-radius: 8px; padding: 8px 0; width: 100%; cursor: pointer; font-size: 13px; font-weight: 500;
        }
        .btn-add { background-color: var(--tg-theme-button-color, #3390ec); color: var(--tg-theme-button-text-color, #fff); }
        .btn-info { background: transparent; color: var(--tg-theme-link-color, #3390ec); margin-top: 5px; }

        /* –í–°–ü–õ–´–í–ê–Æ–©–ï–ï –û–ö–ù–û (POPUP) */
        #popup {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 100;
            align-items: center; justify-content: center;
        }
        .popup-inner {
            background: var(--tg-theme-bg-color, #fff);
            padding: 25px; border-radius: 16px; width: 80%; max-width: 320px; text-align: center; position: relative;
        }
        .close { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #aaa; }
    </style>
</head>
<body>

    <h1>üî• –ì–æ—Ä—è—á–∏–µ —Ç–æ–≤–∞—Ä—ã</h1>
    <div class="grid" id="products-list"></div>

    <!-- –û–ö–ù–û –û–ü–ò–°–ê–ù–ò–Ø -->
    <div id="popup">
        <div class="popup-inner">
            <div class="close" onclick="closePopup()">√ó</div>
            <div id="p-icon" style="font-size: 60px;"></div>
            <h2 id="p-title"></h2>
            <p id="p-desc" style="color: #777; margin: 10px 0;"></p>
            <h3 id="p-price"></h3>
            <button class="btn-add" id="p-btn" style="padding: 12px;">–í –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // 10 –¢–û–í–ê–†–û–í
        const db = [
            {id: 1, name: "Iphone 15 Pro", price: 1000, icon: "üì±", desc: "–¢–∏—Ç–∞–Ω–æ–≤—ã–π –∫–æ—Ä–ø—É—Å, –º–æ—â–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä A17 Pro."},
            {id: 2, name: "AirPods Pro", price: 2000, icon: "üéß", desc: "–ê–∫—Ç–∏–≤–Ω–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ä–µ–∂–∏–º."},
            {id: 3, name: "MacBook Air", price: 5000, icon: "üíª", desc: "–õ–µ–≥–∫–∏–π –∏ –º–æ—â–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ –Ω–∞ —á–∏–ø–µ M2."},
            {id: 4, name: "Apple Watch", price: 3000, icon: "‚åö", desc: "–í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–Ω—ã–π –¥–∏—Å–ø–ª–µ–π Retina."},
            {id: 5, name: "PlayStation 5", price: 4500, icon: "üéÆ", desc: "–ò–≥—Ä–æ–≤–∞—è –∫–æ–Ω—Å–æ–ª—å –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è."},
            {id: 6, name: "Dyson", price: 3500, icon: "üí®", desc: "–§–µ–Ω –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —É–∫–ª–∞–¥–∫–∏ –≤–æ–ª–æ—Å."},
            {id: 7, name: "–ö–æ—Ñ–µ–º–∞—à–∏–Ω–∞", price: 1500, icon: "‚òï", desc: "–í–∞—Ä–∏—Ç —ç—Å–ø—Ä–µ—Å—Å–æ –∏ –∫–∞–ø—É—á–∏–Ω–æ –æ–¥–Ω–∏–º –Ω–∞–∂–∞—Ç–∏–µ–º."},
            {id: 8, name: "–≠–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç", price: 6000, icon: "üõ¥", desc: "–ó–∞–ø–∞—Å —Ö–æ–¥–∞ 45 –∫–º, —Å–∫–æ—Ä–æ—Å—Ç—å –¥–æ 25 –∫–º/—á."},
            {id: 9, name: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏ Nike", price: 1200, icon: "üëü", desc: "–£–¥–æ–±–Ω–∞—è –æ–±—É–≤—å –¥–ª—è –±–µ–≥–∞ –∏ –ø—Ä–æ–≥—É–ª–æ–∫."},
            {id: 10, name: "–†—é–∫–∑–∞–∫", price: 800, icon: "üéí", desc: "–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–π –≥–æ—Ä–æ–¥—Å–∫–æ–π —Ä—é–∫–∑–∞–∫."}
        ];

        let cart = [];
        const list = document.getElementById('products-list');

        // –†–ò–°–£–ï–ú –¢–û–í–ê–†–´
        db.forEach(item => {
            const el = document.createElement('div');
            el.className = 'card';
            el.innerHTML = `
                <div class="icon">${item.icon}</div>
                <div class="title">${item.name}</div>
                <div class="price">${item.price} ‚ÇΩ</div>
                <button class="btn-add" onclick="add(${item.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn-info" onclick="show(${item.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            `;
            list.appendChild(el);
        });

        // –î–û–ë–ê–í–õ–ï–ù–ò–ï –í –ö–û–†–ó–ò–ù–£
        function add(id) {
            const item = db.find(i => i.id === id);
            cart.push(item);
            tg.HapticFeedback.impactOccurred('light'); // –í–∏–±—Ä–∞—Ü–∏—è
            updateBtn();
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ì–õ–ê–í–ù–û–ô –ö–ù–û–ü–ö–ò
        function updateBtn() {
            if (cart.length === 0) {
                tg.MainButton.hide();
            } else {
                const total = cart.reduce((sum, i) => sum + i.price, 0);
                tg.MainButton.setText(`–û–ø–ª–∞—Ç–∏—Ç—å ${total} ‚ÇΩ (${cart.length} —à—Ç)`);
                tg.MainButton.show();
            }
        }

        // –ü–û–ö–ê–ó –û–ü–ò–°–ê–ù–ò–Ø
        function show(id) {
            const item = db.find(i => i.id === id);
            document.getElementById('p-icon').innerText = item.icon;
            document.getElementById('p-title').innerText = item.name;
            document.getElementById('p-desc').innerText = item.desc;
            document.getElementById('p-price').innerText = item.price + " ‚ÇΩ";
            document.getElementById('p-btn').onclick = () => { add(id); closePopup(); };
            document.getElementById('popup').style.display = 'flex';
        }

        function closePopup() { document.getElementById('popup').style.display = 'none'; }

        // –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• –ë–û–¢–£
        tg.MainButton.onClick(() => {
            const total = cart.reduce((sum, i) => sum + i.price, 0);
            const data = JSON.stringify({ total: total, items: cart.map(i => i.name) });
            tg.sendData(data);
        });
    </script>
</body>
</html>
